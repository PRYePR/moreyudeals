# 可折叠分类标签使用指南

## 📱 效果说明

### 移动端体验

**初始状态** (自动展示前6个分类):
```
┌────────────────────────────────────────┐
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🏷️ 全部 (128) │ │ 🎮 游戏 (12)  │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 💻 3C (25)    │ │ 👕 时尚 (18)  │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🏠 家居 (15)  │ │ 💄 美妆 (8)   │ │
│  └────────────────┘ └────────────────┘ │
│                                         │
│      ┌──────────────────────────┐      │
│      │ 显示更多 (8 个分类) ▼   │      │
│      └──────────────────────────┘      │
└────────────────────────────────────────┘
```

**点击"显示更多"后** (展开全部14个分类):
```
┌────────────────────────────────────────┐
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🏷️ 全部 (128) │ │ 🎮 游戏 (12)  │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 💻 3C (25)    │ │ 👕 时尚 (18)  │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🏠 家居 (15)  │ │ 💄 美妆 (8)   │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🚗 汽车 (10)  │ │ 🍔 食品 (22)  │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🧸 玩具 (14)  │ │ 📚 图书 (9)   │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🐾 宠物 (6)   │ │ 💼 办公 (7)   │ │
│  └────────────────┘ └────────────────┘ │
│  ┌────────────────┐ ┌────────────────┐ │
│  │ 🌱 园艺 (11)  │ │ 🏷️ 其他 (13)  │ │
│  └────────────────┘ └────────────────┘ │
│                                         │
│      ┌──────────────────────────┐      │
│      │ 收起 (8 个分类) ▲       │      │
│      └──────────────────────────┘      │
└────────────────────────────────────────┘
```

### 桌面端体验

**直接显示全部分类** (7列网格布局，无折叠按钮):
```
┌─────────────────────────────────────────────────────────────────────────────────┐
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ │
│  │🏷️全部(128)│ │🎮游戏(12) │ │💻3C(25)  │ │👕时尚(18) │ │🏠家居(15) │ │💄美妆(8) │ │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ │
│  │🚗汽车(10) │ │🍔食品(22) │ │🧸玩具(14) │ │📚图书(9) │ │🐾宠物(6) │ │💼办公(7) │ │
│  └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ └──────────┘ │
│  ┌──────────┐ ┌──────────┐                                                      │
│  │🌱园艺(11) │ │🏷️其他(13) │                                                      │
│  └──────────┘ └──────────┘                                                      │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## ✨ 核心特性

### 1. 智能折叠
- **移动端**: 默认显示前 6 个分类（包括"全部"）
- **桌面端**: 直接显示全部 14 个分类
- **自适应**: 根据屏幕宽度自动调整

### 2. 展开/收起按钮
- **按钮位置**: 分类标签下方，居中显示
- **按钮文字**: 动态显示隐藏的分类数量
  - 收起状态: `显示更多 (8 个分类) ▼`
  - 展开状态: `收起 (8 个分类) ▲`
- **显示条件**: 仅在移动端（< 768px）且有更多分类时显示

### 3. 响应式网格
| 屏幕尺寸 | 列数 | 适用设备 |
|----------|------|---------|
| < 640px | 2 | 小屏手机 |
| ≥ 640px | 3 | 大屏手机 |
| ≥ 768px | 4 | 平板 |
| ≥ 1024px | 5 | 笔记本 |
| ≥ 1280px | 7 | 桌面 |

### 4. 数量徽章
- 显示每个分类下的优惠数量
- 激活状态: 半透明白色徽章
- 未激活状态: 灰色背景徽章

## 🎨 视觉设计

### 按钮样式
```tsx
<button className="flex items-center gap-2 px-4 py-2 text-sm font-medium text-brand-primary">
  显示更多 (8 个分类) ▼
</button>
```

### 颜色方案
- **按钮文字**: `text-brand-primary` (品牌主色)
- **按钮悬停**: `hover:text-brand-primary-dark`
- **图标**: ChevronDown / ChevronUp (来自 lucide-react)

## 🔧 技术实现

### 状态管理
```tsx
const [isExpanded, setIsExpanded] = useState(false)
```

### 显示逻辑
```tsx
const MOBILE_DISPLAY_COUNT = 6

const visibleCategories = isExpanded
  ? allDisplayCategories
  : allDisplayCategories.slice(0, MOBILE_DISPLAY_COUNT)

const hasMore = allDisplayCategories.length > MOBILE_DISPLAY_COUNT
```

### 响应式控制
```tsx
{hasMore && (
  <div className="flex justify-center md:hidden">
    {/* 展开/收起按钮 */}
  </div>
)}
```

## 📊 对比优势

| 特性 | 普通网格布局 | 可折叠布局 |
|------|-------------|-----------|
| 移动端初始高度 | 较高（7行） | 较低（3行 + 按钮） |
| 屏幕利用率 | 一般 | 优秀 |
| 用户体验 | 直观 | 简洁 + 可扩展 |
| 适用场景 | < 20 个分类 | 任意数量分类 |
| 桌面端表现 | 完全相同 | 完全相同 |

## 🚀 使用方法

### 当前已启用
该版本已在 `src/app/page.tsx` 中启用：

```tsx
import CategoryTabs from '@/components/filters/CategoryTabsCollapsible'
```

### 如需切换回普通版本
修改 `src/app/page.tsx`:

```tsx
import CategoryTabs from '@/components/filters/CategoryTabs'
```

## 📱 测试清单

### 移动端测试
- [ ] 初始状态显示 6 个分类
- [ ] 显示"显示更多"按钮
- [ ] 按钮显示正确的数量 (8 个分类)
- [ ] 点击按钮展开所有分类
- [ ] 展开后按钮变为"收起"
- [ ] 点击"收起"恢复初始状态
- [ ] 分类标签可正常点击和筛选

### 桌面端测试
- [ ] 直接显示全部 14 个分类
- [ ] 不显示展开/收起按钮
- [ ] 7 列网格布局正确
- [ ] 分类标签可正常点击和筛选

### 响应式测试
- [ ] 在 375px 下正常显示 (iPhone SE)
- [ ] 在 430px 下正常显示 (iPhone 14 Pro)
- [ ] 在 768px 下正常显示 (iPad)
- [ ] 在 1280px 下正常显示 (桌面)
- [ ] 从移动端缩放到桌面端按钮正确消失

## 💡 最佳实践

### 1. 分类数量建议
- **6-15 个分类**: 推荐使用可折叠布局
- **< 6 个分类**: 可直接使用普通网格布局
- **> 15 个分类**: 建议添加搜索功能

### 2. 移动端显示数量
- **当前设置**: 6 个 (包括"全部")
- **可调整**: 修改 `MOBILE_DISPLAY_COUNT` 常量
- **建议范围**: 4-8 个

### 3. 用户体验优化
- 保持展开状态: 可使用 localStorage 记住用户选择
- 平滑动画: 可添加 CSS transition
- 键盘支持: 可添加 Enter/Space 键支持

## 🐛 已知限制

1. **展开状态不持久化**: 刷新页面后恢复到收起状态
2. **无动画过渡**: 展开/收起是瞬间完成的
3. **固定数量**: 移动端显示数量是硬编码的

## 🔮 未来改进方向

1. **记住展开状态**
   ```tsx
   const [isExpanded, setIsExpanded] = useState(() => {
     return localStorage.getItem('categoryExpanded') === 'true'
   })
   ```

2. **添加展开动画**
   ```tsx
   <div className="grid ... transition-all duration-300 ease-in-out">
   ```

3. **动态调整显示数量**
   ```tsx
   const MOBILE_DISPLAY_COUNT = Math.min(6, Math.ceil(categories.length / 2))
   ```

## 📞 支持

如有问题，请查看：
- 主要文档: `CATEGORY_TABS_REDESIGN.md`
- 对比说明: `CATEGORY_LAYOUT_COMPARISON.md`

---

**更新日期**: 2025-11-02
**版本**: v2.0 - Collapsible
**作者**: Claude Code
