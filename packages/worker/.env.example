# Worker Configuration

# ============================================
# 运行环境
# ============================================
NODE_ENV=production

# ============================================
# 数据库配置 (PostgreSQL)
# ============================================
DB_HOST=localhost        # 数据库服务器地址，如: 43.157.40.96
DB_PORT=5432            # 数据库端口，默认 5432
DB_NAME=moreyudeals     # 数据库名称
DB_USER=moreyudeals     # 数据库用户名
DB_PASSWORD=            # 数据库密码

# ============================================
# Sparhamster 配置
# ============================================
# 是否启用 Sparhamster 抓取 (true/false)
# 设置为 false 可以单独测试其他数据源
SPARHAMSTER_ENABLED=true

# Sparhamster API 接口地址
SPARHAMSTER_API_URL=https://www.sparhamster.at/wp-json/wp/v2/posts

# 每次请求获取的文章数量 (建议: 20-100)
SPARHAMSTER_API_LIMIT=20

# Sparhamster 网站基础 URL
SPARHAMSTER_BASE_URL=https://www.sparhamster.at

# Sparhamster API Token (从后台获取)
SPARHAMSTER_TOKEN=your_token_here

# User-Agent (模拟浏览器，防止被拦截)
SPARHAMSTER_USER_AGENT=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36

# ============================================
# Preisjaeger 配置
# ============================================
# 是否启用 Preisjaeger 抓取 (true/false)
PREISJAEGER_ENABLED=true

# Preisjaeger 列表页 URL
PREISJAEGER_LIST_URL=https://www.preisjaeger.at/neu

# 每次最多抓取的详情页数量 (建议: 10-20)
# 避免单次抓取时间过长
PREISJAEGER_MAX_DETAIL_PAGES=20

# 详情页抓取延迟（毫秒）
# 每抓取一个详情页后随机延迟，避免被识别为爬虫
PREISJAEGER_DETAIL_MIN_DELAY=5000   # 最小延迟 5 秒
PREISJAEGER_DETAIL_MAX_DELAY=15000  # 最大延迟 15 秒

# Preisjaeger User-Agent
PREISJAEGER_USER_AGENT=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36

# Preisjaeger 抓取间隔（分钟）
# 建议: 30-60 分钟
PREISJAEGER_FETCH_INTERVAL=30

# ============================================
# 抓取调度配置
# ============================================
# Sparhamster 抓取间隔（分钟）- 主要间隔时间
# 建议: 30-60 分钟，避免频繁请求
FETCH_INTERVAL=30

# 随机延迟范围（分钟）- 防止被检测为爬虫
# 每次抓取会在 FETCH_INTERVAL 基础上增加 [FETCH_RANDOM_DELAY_MIN, FETCH_RANDOM_DELAY_MAX] 的随机延迟
FETCH_RANDOM_DELAY_MIN=0
FETCH_RANDOM_DELAY_MAX=15

# 最大重试次数
MAX_RETRIES=3

# ============================================
# 翻译配置
# ============================================
# 是否启用翻译功能 (true/false)
TRANSLATION_ENABLED=true

# 翻译任务间隔（分钟）
# 建议: 5-10 分钟
TRANSLATION_INTERVAL=5

# 每批次翻译的文章数量
# 建议: 5-20，避免 API 限流
TRANSLATION_BATCH_SIZE=10

# 目标翻译语言（逗号分隔）
# 支持: zh(中文简体), en(英文), zh-TW(中文繁体) 等
TRANSLATION_TARGET_LANGUAGES=zh,en

# 翻译服务提供商（逗号分隔，按优先级排序）
# 支持: microsoft, deepl
# 例如: microsoft,deepl 表示优先使用 Microsoft，失败后使用 DeepL
TRANSLATION_PROVIDERS=microsoft,deepl

# ============================================
# DeepL 翻译服务配置
# ============================================
# DeepL API Key (从 https://www.deepl.com/pro-api 获取)
# 免费版: xxx:fx  专业版: xxx
DEEPL_API_KEY=

# DeepL API 端点
# 免费版: https://api-free.deepl.com/v2
# 专业版: https://api.deepl.com/v2
DEEPL_ENDPOINT=https://api-free.deepl.com/v2

# ============================================
# Microsoft Translator 配置
# ============================================
# 微软翻译 API #1（主）
MICROSOFT_TRANSLATOR_KEY=
MICROSOFT_TRANSLATOR_REGION=global
MICROSOFT_TRANSLATOR_ENDPOINT=https://api.cognitive.microsofttranslator.com

# 微软翻译 API #2（备用，可选）
MICROSOFT_TRANSLATOR_KEY_2=
MICROSOFT_TRANSLATOR_REGION_2=germanywestcentral
MICROSOFT_TRANSLATOR_ENDPOINT_2=https://api.cognitive.microsofttranslator.com

# ============================================
# 联盟链接配置
# ============================================
# Amazon 联盟标识 (用于 Amazon 链接的自动替换)
AMAZON_AFFILIATE_TAG=moreyu0a-21

# ============================================
# Redis 配置（可选 - 用于缓存和队列）
# ============================================
# Redis 连接 URL
# 格式: redis://[username]:[password]@host:port/database
# 示例: redis://localhost:6379
REDIS_URL=redis://localhost:6379

# ============================================
# 日志配置
# ============================================
# 日志级别: debug | info | warn | error
# 生产环境建议使用 info 或 warn
LOG_LEVEL=info

# ============================================
# 配置说明和最佳实践
# ============================================
#
# 1. 数据库配置
#    - 确保数据库已创建并初始化
#    - 用户需要有足够的权限 (SELECT, INSERT, UPDATE)
#
# 2. 数据源开关
#    - SPARHAMSTER_ENABLED: 控制是否抓取 Sparhamster
#    - PREISJAEGER_ENABLED: 控制是否抓取 Preisjaeger
#    - 可以单独启用一个数据源进行测试
#    - 生产环境建议都启用
#
# 3. 抓取配置
#    - FETCH_INTERVAL: 建议 30-60 分钟
#    - RANDOM_DELAY: 增加随机延迟可以降低被识别为爬虫的风险
#    - PREISJAEGER_MAX_DETAIL_PAGES: 控制单次抓取数量，避免时间过长
#    - PREISJAEGER_DETAIL_*_DELAY: 详情页之间的延迟，避免频繁请求
#
# 4. 翻译配置
#    - 生产环境初期建议设置 TRANSLATION_ENABLED=false
#    - 待系统稳定后再启用翻译功能
#    - DeepL 免费版每月 500,000 字符限制
#    - Microsoft Translator 有更高的配额但翻译质量可能稍低
#    - 支持配置多个翻译提供商作为备份
#
# 5. 性能优化
#    - TRANSLATION_BATCH_SIZE 不宜过大，避免单次任务耗时过长
#    - 可以通过 Redis 启用缓存，减少重复翻译
#    - Preisjaeger 的延迟设置要合理，既要避免被封禁，也要保证效率
#
# 6. 联盟链接
#    - AMAZON_AFFILIATE_TAG: 系统会自动清洗 Amazon 链接并替换为你的联盟标识
#    - 适用于 Sparhamster 和 Preisjaeger 中的 Amazon 商品
#
# 7. 安全建议
#    - 不要将此文件提交到 Git 仓库
#    - 定期更换 API Keys
#    - 使用强密码
#    - 生产环境的 .env 文件应单独管理
#
# 8. 测试建议
#    - 初次部署时，建议先设置较小的值进行测试
#    - PREISJAEGER_MAX_DETAIL_PAGES=3 (测试)
#    - PREISJAEGER_DETAIL_MIN_DELAY=2000 (测试)
#    - TRANSLATION_ENABLED=false (测试)
#    - 确认抓取正常后再调整为生产参数
